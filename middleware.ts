import { NextResponse } from "next/server";export const config={matcher:["/api/:path*"]};const hits=new Map<string,{n:number,t:number}>();export default function middleware(req:Request){const ip=(req.headers.get("cf-connecting-ip")||"") as string;const now=Date.now(),win=60_000,limit=60;const h=hits.get(ip)||{n:0,t:now};if(now-h.t>win){h.n=0;h.t=now;}h.n++;hits.set(ip,h);if(h.n>limit)return NextResponse.json({error:"Too Many Requests"},{status:429});return NextResponse.next();}